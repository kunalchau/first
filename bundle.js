!function(e){var t={};function s(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);const n=["blockme.com","api.b2c.com","example.com"];function o(e,t,s){let n,o=0,r=e.length-1;for(;r-o>1;){n=Math.floor((r+o)/2);let e=s(n);if(-1===e)o=n;else{if(1!==e)return!0;r=n}}return 0===s(o)||0===s(r)}function r(e,t){setTimeout((function(){e(),t&&t()}),0)}const i=[...new Set(n)];i.sort();const c=Object.freeze({CONSOLE:1,FILE:2,HTTP:3}),l=Object.freeze({BATCH_LOG:1,EVENT_LOG:2,DEV_LOG:3}),a=Object.freeze({DEBUG:1,INFO:2,WARN:3,ERROR:4}),u=Object.freeze({DEBUG:"[DEBU]",INFO:"[INFO]",WARN:"[WARN]",ERROR:"[ERRO]"}),g=Object.freeze({POPUP:"popup",REDIRECT:"redirect",FAKE_CLICK:"fake_click",EVENT_LISTENER_INVOKED:"event_listener_invoked",CHILDLIST_MUTATION:"childList",ATTRIBUTE_MUTATION:"attribute",CHARACTERDATA_MUTATION:"characterData"}),h={appenders:{consoleLogging:{type:c.CONSOLE}},categories:{c1:{appenders:["consoleLogging"],level:a.DEBUG},none:{appenders:[]},default:{appenders:["consoleLogging"],level:a.DEBUG}}};class d{constructor(){this._timestamp=null,this._message={},this._numLogs=0,this._size=0}addMessage(e){this.size+=e.length,this.message[this.numLogs++]=e}get getObject(){return{timestamp:this.timestamp,message:this.message}}get getJSON(){return JSON.stringify(this.getObject)}get timestamp(){return this._timestamp}set timestamp(e){this._timestamp=e}get message(){return this._message}set message(e){this._message=e}get numLogs(){return this._numLogs}set numLogs(e){this._numLogs=e}get size(){return this._size}set size(e){this._size=e}}class _{constructor(){this._malicious=null,this._event=null,this._url=null,this._html=null}set attributeValues(e){this.malicious=e[0],this.event=e[1],this.url=e[2],this.html=e[3]}get getObject(){return{malicious:this.malicious,event:this.event,url:this.url,html:this.html}}get getJSON(){return JSON.stringify(this.getObject)}get malicious(){return this._malicious}set malicious(e){this._malicious=e}get event(){return this._event}set event(e){this._event=e}get url(){return this._url}set url(e){this._url=e}get html(){return this._html}set html(e){this._html=e}}class O{constructor(){this._objectList=[]}get objectList(){return this._objectList}addObjects(e){this._objectList.push(...e)}}class f{static createLogObject(e){return e===l.BATCH_LOG?new d:e===l.EVENT_LOG?new _:e===l.DEV_LOG?new O:void 0}}class m{constructor(e){this._loggers=[],this._level=e||a.INFO}_handleUnloadEvent(){window.addEventListener("unload",e=>{this._logBatch(this._batchLogObject.getObject)})}_logBatch(){this._batchLogObject.timestamp=function(){let e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+(e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+":"+e.getMilliseconds())}(),this._loggers.forEach(e=>{e.logBatch(this._batchLogObject.getObject)})}_logDev(e,t){this._level<=e&&this._loggers.forEach(s=>{switch(e){case a.DEBUG:s.debug(t);break;case a.INFO:s.info(t);break;case a.WARN:s.warn(t);break;case a.ERROR:s.error(t)}})}log(...e){r(()=>{let t=f.createLogObject(l.EVENT_LOG);t.attributeValues=e,this._loggers.forEach(e=>{e.log(t.getObject)})},null)}debug(...e){r(()=>{let t=f.createLogObject(l.DEV_LOG);t.addObjects(e),this._logDev(a.DEBUG,t)},null)}info(...e){r(()=>{let t=f.createLogObject(l.DEV_LOG);t.addObjects(e),this._logDev(a.INFO,t)},null)}warn(...e){r(()=>{let t=f.createLogObject(l.DEV_LOG);t.addObjects(e),this._logDev(a.WARN,t)},null)}error(...e){r(()=>{let t=f.createLogObject(l.DEV_LOG);t.addObjects(e),this._logDev(a.ERROR,t)},null)}addLogger(e){this._loggers.push(e)}}class b{constructor(){return b._instance||(this.type=c.CONSOLE,b._instance=this),b._instance}log(e){console.log(e)}logBatch(e){console.log(e)}debug(e){console.log(u.DEBUG,...e.objectList)}info(e){console.log(u.INFO,...e.objectList)}warn(e){console.log(u.WARN,...e.objectList)}error(e){console.log(u.ERROR,...e.objectList)}}class p{static createLogger(e){if(e.type===c.CONSOLE)return new b}}class L{static configure(e){L._config={_appenders:e.appenders,_categories:e.categories}}static getLogger(e){e=e||"default";let t=L._config._appenders,s=L._config._categories,n=new m(s[e].level);return s[e].appenders.forEach(e=>{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&e===s&&n.addLogger(p.createLogger(t[e]))}),n}}L.configure(h);const E=L.getLogger("c1");function v(e){var t;e.open=(t=e.open,(s,n,r)=>{let c=!1;var l;return(void 0===s||""===s||(l=function(e){let t=document.createElement("a");return t.href=e,t.hostname.toLocaleLowerCase()}(s),o(i,0,e=>i[e].localeCompare(l)))||"_blank"===n||void 0!==r&&""!==r)&&(c=!0),E.log(c,g.POPUP,s),t.call(e,s,n,r)})}const T=["click","dblclick","focus","blur"];T.sort();const j=[...new Set(n)];function N(e){var t;e.addEventListener=(t=e.addEventListener,(s,n,r)=>{t.call(e,s,e=>{let t=function(e){return o(T,0,t=>T[t].localeCompare(e))}(e.type),s=!e.isTrusted&&!0===t;s?(E.log(s,g.EVENT_LISTENER_INVOKED,null,n.toString()),e.stopPropagation(),e.stopImmediatePropagation()):n(e)},r)})}j.sort();const D=!0,R=!0,I=!0,A=!0,y={attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0};const w=new MutationObserver((function(e){e.forEach(e=>{"childList"===e.type?(e.addedNodes.length>0&&A&&e.addedNodes.forEach(e=>{"IFRAME"===e.tagName&&e.addEventListener("load",t=>{w.observe(e.contentDocument,y)})}),E.log(null,g.CHILDLIST_MUTATION,null,e.target.outerHTML)):"attributes"===e.type?E.log(null,g.ATTRIBUTE_MUTATION,null,e.target.outerHTML):"characterData"===e.type&&E.log(null,g.CHARACTERDATA_MUTATION,null,e.target.nodeValue)})}));D&&function(e){E.info("starting popup checks"),v(e)}(window),R&&function(e){E.info("starting redirect checks");let t=e.document,s=t.getElementsByTagName("*");N(t);for(let e=0;e<s.length;e++)N(s[e])}(window),I&&function(e){E.info("starting MutationObserver checks");let t=e.document;if(w.observe(t,y),A){let e=t.getElementsByTagName("iframe");for(let t=0;t<e.length;t++)e[t].addEventListener("load",s=>{w.observe(e[t].contentDocument,y)})}}(window)}]);